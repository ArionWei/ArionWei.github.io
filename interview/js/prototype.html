<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>原型与原型链 | 前端小册</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/images/js.ico">
    <meta name="description" content="打发无聊时间">
    <link rel="preload" href="/assets/css/0.styles.599e61b5.css" as="style"><link rel="preload" href="/assets/js/app.a17c348c.js" as="script"><link rel="preload" href="/assets/js/2.7309e51e.js" as="script"><link rel="preload" href="/assets/js/8.76d1b0fd.js" as="script"><link rel="prefetch" href="/assets/js/10.fecb153a.js"><link rel="prefetch" href="/assets/js/11.b50021fd.js"><link rel="prefetch" href="/assets/js/12.f18047ff.js"><link rel="prefetch" href="/assets/js/13.f79a18de.js"><link rel="prefetch" href="/assets/js/14.232cd1f3.js"><link rel="prefetch" href="/assets/js/15.eeefbb1b.js"><link rel="prefetch" href="/assets/js/16.1829395c.js"><link rel="prefetch" href="/assets/js/17.96d700e8.js"><link rel="prefetch" href="/assets/js/18.4ee9723d.js"><link rel="prefetch" href="/assets/js/19.945a87a4.js"><link rel="prefetch" href="/assets/js/20.9fae2fae.js"><link rel="prefetch" href="/assets/js/21.0cd816f8.js"><link rel="prefetch" href="/assets/js/22.6a6386cf.js"><link rel="prefetch" href="/assets/js/23.d706bf19.js"><link rel="prefetch" href="/assets/js/24.14743dda.js"><link rel="prefetch" href="/assets/js/25.13726be5.js"><link rel="prefetch" href="/assets/js/26.644ad5c9.js"><link rel="prefetch" href="/assets/js/27.9818d038.js"><link rel="prefetch" href="/assets/js/28.b16ed616.js"><link rel="prefetch" href="/assets/js/29.f1aae2ef.js"><link rel="prefetch" href="/assets/js/3.34adbfb4.js"><link rel="prefetch" href="/assets/js/30.1a733cbc.js"><link rel="prefetch" href="/assets/js/31.280cde12.js"><link rel="prefetch" href="/assets/js/32.72661153.js"><link rel="prefetch" href="/assets/js/33.5bb4101d.js"><link rel="prefetch" href="/assets/js/34.6e92a4d9.js"><link rel="prefetch" href="/assets/js/35.46dfd907.js"><link rel="prefetch" href="/assets/js/36.3114bd43.js"><link rel="prefetch" href="/assets/js/37.8e7f1585.js"><link rel="prefetch" href="/assets/js/38.8f79926d.js"><link rel="prefetch" href="/assets/js/39.930acbf0.js"><link rel="prefetch" href="/assets/js/4.3cb7a180.js"><link rel="prefetch" href="/assets/js/5.994cf741.js"><link rel="prefetch" href="/assets/js/6.5c16144e.js"><link rel="prefetch" href="/assets/js/7.b81f1b37.js"><link rel="prefetch" href="/assets/js/9.bd2387c4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.599e61b5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">前端小册</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/tutorials/basicGrammar/statement.html" class="nav-link">
  基础进阶
</a></div><div class="nav-item"><a href="/interview/js/variable_hoisting.html" class="nav-link">
  知识积累
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/tutorials/basicGrammar/statement.html" class="nav-link">
  基础进阶
</a></div><div class="nav-item"><a href="/interview/js/variable_hoisting.html" class="nav-link">
  知识积累
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JS 相关</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/interview/js/variable_hoisting.html" class="sidebar-link">谈谈变量提升</a></li><li><a href="/interview/js/call,apply,bind.html" class="sidebar-link">call，apply，bind</a></li><li><a href="/interview/js/typeof_instanceof.html" class="sidebar-link">typeof 与 instanceof</a></li><li><a href="/interview/js/throttle_debounce.html" class="sidebar-link">函数节流与防抖</a></li><li><a href="/interview/js/prototype.html" class="active sidebar-link">原型与原型链</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>vue相关</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>interview</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="原型与原型链"><a href="#原型与原型链" class="header-anchor">#</a> 原型与原型链</h1> <div align="center"><img src="/images/prototype.jpg" width="500"></div> <h3 id="prototype"><a href="#prototype" class="header-anchor">#</a> <code>prototype</code></h3> <p><code>prototype</code>是一个显式原型属性，基本上每个函数都有该属性，但是有个特例：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> fun <span class="token operator">=</span> <span class="token class-name">Function</span><span class="token punctuation">.</span><span class="token function">prototype</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
fun<span class="token punctuation">.</span>prototype <span class="token comment">// undefined</span>
</code></pre></div><p>当我们声明一个函数时，<code>prototype</code>属性就被自动创建了。而且这个属性值是一个对象，也就是原型对象，这个对象中只有一个<code>constructor</code>属性，<code>constructor</code>属性值就是我们声明的函数。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Foo</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> proto <span class="token operator">=</span> <span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype <span class="token comment">// proto : {constructor: ƒ}</span>
proto<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Foo <span class="token comment">// true</span>
</code></pre></div><h4 id="constructor"><a href="#constructor" class="header-anchor">#</a> <code>constructor</code></h4> <p><code>constructor</code> 是一个公有且不可枚举的属性。一旦我们改变了函数的<code>prototype</code>，那么新对象就没有这个属性了（当然可以通过原型链取到 <code>constructor</code>）。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'David'</span><span class="token punctuation">}</span>
<span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype <span class="token comment">// {name: 'David'}</span>
</code></pre></div><blockquote><p>constructor属性不影响任何JavaScript的内部属性。constructor其实没有什么用处，只是JavaScript语言设计的历史遗留物。</p></blockquote> <h3 id="proto"><a href="#proto" class="header-anchor">#</a> <code>__proto__</code></h3> <p>由上面的图片我们可以知道，使用<code>new</code>操作符之后生成的实例对象就有了<code>__proto__</code>属性。</p> <p>每个实例对象都有<code>__proto__</code>属性，该属性指向的是创造该对象的构造函数的原型对象。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Foo</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
obj<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype <span class="token comment">// true</span>
</code></pre></div><p>所以可以说，在<code>new</code>的过程中，新对象被添加了 <code>__proto__</code> 并且链接到构造函数的原型上。</p> <p><code>new</code>命令简化的内部流程，可以用下面的代码表示。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">_new</span><span class="token punctuation">(</span><span class="token comment">/* 构造函数 */</span> constructor<span class="token punctuation">,</span> <span class="token comment">/* 构造函数参数 */</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 将 arguments 对象转为数组</span>
  <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 取出构造函数</span>
  <span class="token keyword">var</span> constructor <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 创建一个空对象，继承构造函数的 prototype 属性</span>
  <span class="token keyword">var</span> context <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>constructor<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 执行构造函数</span>
  <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">constructor</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 如果返回结果是对象，就直接返回，否则返回 context 对象</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> result <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> result <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> result <span class="token operator">:</span> context<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>由上图可知，构造函数<code>Foo</code>也有<code>__proto__</code>属性，属性值是<code>Function</code>的原型对象，说明声明的函数也是个对象（万物皆对象）。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 这个函数是 Function 的实例对象</span>
<span class="token comment">// function 就是一个语法糖</span>
<span class="token comment">// 内部调用了 new Function(...)</span>
<span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>因为每个对象都有<code>__proto__</code>属性，当我们使用字面量声明一个对象时，该对象的<code>__proto__</code>属性值是<code>Object</code>的原型对象。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 这个字面量内部也是使用了 new Object()</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span> b<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
</code></pre></div><h3 id="原型链"><a href="#原型链" class="header-anchor">#</a> 原型链</h3> <blockquote><p>每个对象都可以有一个原型<code>__proto__</code>，这个原型还可以有它自己的原型，以此类推，形成一个原型链。查找特定属性的时候，我们先去这个对象里去找，如果没有的话就去它的原型对象里面去，如果还是没有的话再去向原型对象的原型对象里去寻找...... 这个操作被委托在整个原型链上，这个就是我们说的原型链了。</p></blockquote> <p>写个简单的例子：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 声明一个构造函数</span>
<span class="token keyword">function</span> <span class="token function">Fun</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
<span class="token punctuation">}</span>
<span class="token comment">// 给原型添加属性和方法</span>
<span class="token class-name">Fun</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">18</span>
<span class="token class-name">Fun</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 创建实例</span>
<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fun</span><span class="token punctuation">(</span><span class="token string">'David'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span> <span class="token comment">// {name: &quot;David&quot;}</span>

<span class="token comment">// 访问实例对象的属性和方法</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// David</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>age<span class="token punctuation">)</span> <span class="token comment">// 18</span>
o<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// David</span>
o<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object Object]&quot;</span>
</code></pre></div><p>由上面例子可知，通过构造函数创建了实例对象之后，<code>name</code>成为了实例对象自己的属性，我们可以直接访问，这个毋庸置疑。</p> <p>当我们访问<code>age</code>和<code>getName</code>时，它会先在对象自身中寻找，如果有则直接使用，如果没有则会通过<code>__proto__</code>属性去原型对象中寻找，如果找到则直接使用。如果没有则通过<code>__proto__</code>属性去原型的原型中寻找，直到找到<code>Object</code>对象的原型，<code>Object</code>对象的原型没有原型，如果在<code>Object</code>原型中依然没有找到，则返回<code>undefined</code>。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新时间:</span> <span class="time">2020-06-17 17:58</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/interview/js/throttle_debounce.html" class="prev">
        函数节流与防抖
      </a></span> <span class="next"><a href="/interview/vue/01_v-show&amp;v-if.html">
        v-show 与 v-if 的区别
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.a17c348c.js" defer></script><script src="/assets/js/2.7309e51e.js" defer></script><script src="/assets/js/8.76d1b0fd.js" defer></script>
  </body>
</html>
